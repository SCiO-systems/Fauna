if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
ln1<-which.min(abs(mod_ln - 33.875))
ln2<-which.min(abs(mod_ln - 47.625))
lt1<-which.min(abs(mod_lt - 2.625))
lt2<-which.min(abs(mod_lt - 15.125))
var_f2<-var_f1[ln1:ln2,lt1:lt2, ] #to
dim(var_obs2)
dim(var_f2)
n=2
var_obs2<-var_obs1[19:79,61:109, ]
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
ln1<-which.min(abs(mod_ln - 33.875))
ln2<-which.min(abs(mod_ln - 47.625))
lt1<-which.min(abs(mod_lt - 2.625))
lt2<-which.min(abs(mod_lt - 15.125))
var_f2<-var_f1[ln1:ln2,lt1:lt2, ]
dim(var_obs2)
dim(var_f2)
n=3
var_obs2<-var_obs1[22:76,58:109, ]
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
ln1<-which.min(abs(mod_ln - 33.875))
ln2<-which.min(abs(mod_ln - 47.625))
lt1<-which.min(abs(mod_lt - 2.625))
lt2<-which.min(abs(mod_lt - 15.125))
var_f2<-var_f1[ln1:ln2,lt1:lt2, ] #to make lon consistent with the model
dim(var_obs2)
dim(var_f2)
n
n=4
var_obs2<-var_obs1[22:77,59:109, ]
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
ln1<-which.min(abs(mod_ln - 33.875))
ln2<-which.min(abs(mod_ln - 47.625))
lt1<-which.min(abs(mod_lt - 2.625))
lt2<-which.min(abs(mod_lt - 15.125))
var_f2<-var_f1[ln1:ln2,lt1:lt2, ] #
dim(var_obs2)
dim(var)f2
dim(var_f2)
n
n=6
var_obs2<-var_obs1[19:79,61:109, ]
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
ln1<-which.min(abs(mod_ln - 33.875))
ln2<-which.min(abs(mod_ln - 47.625))
lt1<-which.min(abs(mod_lt - 2.625))
lt2<-which.min(abs(mod_lt - 15.125))
var_f2<-var_f1[ln1:ln2,lt1:lt2, ] #t
dim(var_obs2)
dim(var_f2)
n
n=7
var_obs2<-var_obs1[22:77,59:109, ]
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
ln1<-which.min(abs(mod_ln - 33.875))
ln2<-which.min(abs(mod_ln - 47.625))
lt1<-which.min(abs(mod_lt - 2.625))
lt2<-which.min(abs(mod_lt - 15.125))
var_f2<-var_f1[ln1:ln2,lt1:lt2, ] #
dim(var_obs2)
dim(var_f2)
n=1
var_obs2<-var_obs1[22:77,59:109, ]
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
##
ln1<-which(mod_ln == 33.875)
ln2<-which(mod_ln == 47.625)
lt1<-which(mod_lt == 2.625)
lt2<-which(mod_lt == 15.125)
var_f2<-var_f1[ln1:ln2,lt1:lt2, ]
dim(var_obs2)
dim(var_f2)
n=2
var_obs2<-var_obs1[19:79,61:109, ]
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
ln1<-which(mod_ln == 33.875)
ln2<-which(mod_ln == 47.625)
lt1<-which(mod_lt == 2.625)
lt2<-which(mod_lt == 15.125)
var_f2<-var_f1[ln1:ln2,lt1:lt2, ] #to ma
ln1
n
n=2
var_obs<-nc_open(paste0(dir,'observed_baseline/agmerra/',var1[i],'_daily_ts_agmerra_1980_2010_eaf_inv.nc'))
var_obs1<-ncvar_get(var_obs, var1[i])
obs_lt<-ncvar_get(var_obs,"latitude")
obs_ln<-ncvar_get(var_obs,"longitude")
var_obs2<-var_obs1[19:79,61:109, ]
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
mod_ln
n
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
ln1<-which.min(abs(mod_ln - 33.875))
ln2<-which.min(abs(mod_ln - 47.625))
lt1<-which.min(abs(mod_lt - 2.625))
lt2<-which.min(abs(mod_lt - 15.125))
var_f2<-var_f1[ln1:ln2,lt1:lt2, ] #
dim(var_obs2)
dim(var_f2)
n=3
var_obs2<-var_obs1[22:76,58:109, ]
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
ln1<-which.min(abs(mod_ln - 33.875))
ln2<-which.min(abs(mod_ln - 47.625))
lt1<-which.min(abs(mod_lt - 2.625))
lt2<-which.min(abs(mod_lt - 15.125))
var_f2<-var_f1[ln1:ln2,lt1:lt2, ] #
dim(var_obs2)
dim(var_f2)
n
n=4
var_obs2<-var_obs1[22:77,59:109, ]
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
ln1<-which.min(abs(mod_ln - 33.875))
ln2<-which.min(abs(mod_ln - 47.625))
lt1<-which.min(abs(mod_lt - 2.625))
lt2<-which.min(abs(mod_lt - 15.125))
var_f2<-var_f1[ln1:ln2,lt1:lt2, ]
dim(var_obs2)
dim(var_f2)
n
n=6
var_obs2<-var_obs1[19:79,61:109, ]
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
ln1<-which.min(abs(mod_ln - 33.875))
ln2<-which.min(abs(mod_ln - 47.625))
lt1<-which.min(abs(mod_lt - 2.625))
lt2<-which.min(abs(mod_lt - 15.125))
var_f2<-var_f1[ln1:ln2,lt1:lt2, ]
dim(var_obs2)
dim(var_f2)
n
n=7
var_obs2<-var_obs1[22:77,59:109, ]
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
ln1<-which.min(abs(mod_ln - 33.875))
ln2<-which.min(abs(mod_ln - 47.625))
lt1<-which.min(abs(mod_lt - 2.625))
lt2<-which.min(abs(mod_lt - 15.125))
var_f2<-var_f1[ln1:ln2,lt1:lt2, ] #t
dim(var_f2
)
dim(var_obs2)
rm(list=ls())
library(ncdf4)
## Input directory
dir<-'//dapadfs/workspace_cluster_12/AVISA/data_for_dssat_eaf/'
## Input variables
mod<-c('BCC-CSM2-MR','canESM5','EC-Earth3-Veg','GFDL-ESM4','IPSL-CM6A-LR','MIROC6','MRI-ESM2-0')
ti<-c('2030','2060')
prd<-c('201501-204412', '204501-207412')
sc<-c("126","245","370","585")
var<-c('tasmax','tasmin','rsds')
var1<-c('tmax','tmin','srad')
i=1
k=1
j=1
i=1
var_obs<-nc_open(paste0(dir,'observed_baseline/agmerra/',var1[i],'_daily_ts_agmerra_1980_2010_eaf_inv.nc'))
var_obs1<-ncvar_get(var_obs, var1[i])
obs_lt<-ncvar_get(var_obs,"latitude")
obs_ln<-ncvar_get(var_obs,"longitude")
obs_lt
rm(list=ls())
library(ncdf4)
dir<-'//dapadfs/workspace_cluster_12/AVISA/data_for_dssat_eaf/'
## Input variables
mod<-c('BCC-CSM2-MR','canESM5','EC-Earth3-Veg','GFDL-ESM4','IPSL-CM6A-LR','MIROC6','MRI-ESM2-0')
ti<-c('2030','2060')
prd<-c('201501-204412', '204501-207412')
sc<-c("126","245","370","585")
var<-c('tasmax','tasmin','rsds')
var1<-c('tmax','tmin','srad')
n=5
k=1
j=1
i=1
var_obs<-nc_open(paste0(dir,'observed_baseline/agmerra/',var1[i],'_daily_ts_agmerra_1980_2010_eaf_inv.nc'))
var_obs1<-ncvar_get(var_obs, var1[i])
obs_lt<-ncvar_get(var_obs,"latitude")
obs_ln<-ncvar_get(var_obs,"longitude")
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
ln1<-which.min(abs(mod_ln - 33.875))
ln2<-which.min(abs(mod_ln - 47.625))
lt1<-which.min(abs(mod_lt - 2.625))
lt2<-which.min(abs(mod_lt - 15.125))
var_f2<-var_f1[ln1:ln2,lt1:lt2, ] #
obs_ln
mod_ln
n
paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc')
mod_ln
n
dd<-nc_open("//dapadfs/workspace_cluster_12/AVISA/data_for_dssat_eaf/cc_raw/regrid/future/Ethiopia/2030/tasmax_Amon_IPSL-CM6A-LR_ssp126_r1i1p1f1_re_gr_Ethi_monmean_201501-204412.nc")
dd_ln<-ncvar_get(dd, "lon")
dd_ln
setwd('//dapadfs/workspace_cluster_12/AVISA/data_for_dssat_eaf/cc_raw/regrid/future/Ethiopia/2030/')
library(ncdf4)
hi<-nc_open('tasmax_Amon_IPSL-CM6A-LR_ssp126_r1i1p1f1_re_gr_Ethi_monmean_201501-204412.nc')
hi_ln<-ncvar_get(hi,"lon")
hi_ln
library(ncdf4)
## Input directory
dir<-'//dapadfs/workspace_cluster_12/AVISA/data_for_dssat_eaf/'
## Input variables
mod<-c('BCC-CSM2-MR','canESM5','EC-Earth3-Veg','GFDL-ESM4','IPSL-CM6A-LR','MIROC6','MRI-ESM2-0')
ti<-c('2030','2060')
prd<-c('201501-204412', '204501-207412')
sc<-c("126","245","370","585")
var<-c('tasmax','tasmin','rsds')
var1<-c('tmax','tmin','srad')
n=5
k=1
j=1
i=1
var_obs<-nc_open(paste0(dir,'observed_baseline/agmerra/',var1[i],'_daily_ts_agmerra_1980_2010_eaf_inv.nc'))
var_obs1<-ncvar_get(var_obs, var1[i])
obs_lt<-ncvar_get(var_obs,"latitude")
obs_ln<-ncvar_get(var_obs,"longitude")
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
mod_ln
obs_ln
obs_ln[27:77]
mod_ln
obs_lt
mod_lt
obs_lt[59:109]
n
n==2 | n==6
n==5
if(n==2 | n==6){
var_obs2<-var_obs1[19:79,61:109, ]
} else if (n==5) {
var_obs2<-var_obs1[27:77,59:109, ]
} else if (n==3) {
var_obs2<-var_obs1[22:76,58:109, ]
} else {
var_obs2<-var_obs1[22:77,59:109, ]
}
dim(var_obs2)
if(n==3 | n==5){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr_Ethi_monmean_',prd[k],'.nc'))
} else if (n==4){
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gr1_Ethi_monmean_',prd[k],'.nc'))
} else {
var_f<-nc_open(paste0(dir,'cc_raw/regrid/future/Ethiopia/',ti[k],'/',var[i],'_Amon_',mod[n],'_ssp',sc[j],'_',
'r1i1p1f1_re_gn_Ethi_monmean_',prd[k],'.nc'))
}
if(i==3){
var_f1<-ncvar_get(var_f,var[i])*0.0864 ## convert w/m2 to MJ/m2/day
} else {
var_f1<-ncvar_get(var_f,var[i])-273 ## convert kelvin to 0C.
}
mod_lt<-ncvar_get(var_f,"lat")
mod_ln<-ncvar_get(var_f, "lon")
ln1<-which.min(abs(mod_ln - 33.875))
ln2<-which.min(abs(mod_ln - 47.625))
lt1<-which.min(abs(mod_lt - 2.625))
lt2<-which.min(abs(mod_lt - 15.125))
var_f2<-var_f1[ln1:ln2,lt1:lt2, ] #to m
dim(var_f2)
q()
